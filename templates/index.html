<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LocaGo! - Kh√°m ph√° ƒëi·ªÉm ƒë·∫øn</title>
  <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }

      body {
          font-family: -apple-system, BlinkMacSystemFont, 'Poppins', 'Segoe UI', sans-serif;
          background: #f5f5f5;
          min-height: 100vh;
      }

      @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');

      /* Header */
      header {
          background: white;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
          padding: 15px 30px;
          position: sticky;
          top: 0;
          z-index: 1000;
      }

      .header-container {
          max-width: 1400px;
          margin: 0 auto;
          display: flex;
          justify-content: space-between;
          align-items: center;
      }

      .logo {
          font-size: 32px;
          font-weight: 700;
          color: #1C6758;
          text-decoration: none;
          font-family: 'Poppins', sans-serif;
      }

      .logo span {
          color: #8EB486;
      }

      .nav-links {
          display: flex;
          gap: 20px;
          align-items: center;
      }

      .nav-links a, .nav-links select {
          text-decoration: none;
          color: #333;
          padding: 10px 18px;
          border-radius: 8px;
          transition: 0.3s;
          border: none;
          background: transparent;
          cursor: pointer;
          font-size: 15px;
          font-weight: 500;
          font-family: 'Poppins', sans-serif;
      }

      .nav-links a:hover {
          background: #f0f0f0;
      }

      .btn-primary {
          background: linear-gradient(135deg, #1C6758, #8EB486) !important;
          color: white !important;
          font-weight: 600;
      }

      .btn-secondary {
          border: 2px solid #1C6758 !important;
          color: #1C6758 !important;
          font-weight: 600;
      }

      /* Ph·∫ßn Hero */
      .hero {
          background: linear-gradient(135deg, #8EB486 0%, #1C6758 100%);
          padding: 60px 20px;
          text-align: center;
          color: white;
      }

      .hero h1 {
          font-size: 3em;
          margin-bottom: 15px;
          font-weight: 700;
          font-family: 'Poppins', sans-serif;
      }

      .hero p {
          font-size: 1.2em;
          margin-bottom: 40px;
          opacity: 0.95;
          font-weight: 400;
      }

      /* Khung t√¨m ki·∫øm */
      .search-container {
          max-width: 900px;
          margin: 0 auto;
          background: rgba(255, 255, 255, 0.95);
          border-radius: 20px;
          padding: 35px;
          box-shadow: 0 10px 40px rgba(0,0,0,0.2);
      }

      .search-tabs {
          display: flex;
          gap: 10px;
          margin-bottom: 25px;
          flex-wrap: wrap;
      }

      .tab {
          padding: 12px 24px;
          border: 2px solid #e0e0e0;
          border-radius: 50px;
          background: white;
          cursor: pointer;
          transition: 0.3s;
          font-size: 15px;
          font-weight: 500;
          color: #555;
      }

      .tab.active {
          background: linear-gradient(135deg, #8EB486, #1C6758);
          color: white;
          border-color: transparent;
          box-shadow: 0 4px 15px rgba(0,0,0,0.15);
      }

      .tab:hover {
          border-color: #8EB486;
      }

      .search-form {
          display: none;
      }

      .search-form.active {
          display: block;
      }

      .search-row {
          display: flex;
          gap: 10px;
          margin-bottom: 15px;
          flex-wrap: wrap;
      }

      .search-row input, .search-row select {
          flex: 1;
          min-width: 200px;
          padding: 15px 20px;
          border: 2px solid #e0e0e0;
          border-radius: 50px;
          font-size: 15px;
          font-weight: 500;
          outline: none;
          transition: 0.3s;
          background: white;
      }

      .search-row input:focus, .search-row select:focus {
          border-color: #8EB486;
          box-shadow: 0 0 0 3px rgba(78, 205, 196, 0.1);
      }

      .search-button {
          padding: 15px 40px;
          background: linear-gradient(135deg, #8EB486, #1C6758);
          color: white;
          border: none;
          border-radius: 50px;
          cursor: pointer;
          font-size: 16px;
          font-weight: 600;
          transition: 0.3s;
          box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      }

      .search-button:hover {
          transform: translateY(-2px);
          box-shadow: 0 6px 20px rgba(78, 205, 196, 0.4);
      }

      /* G·ª£i √Ω t√¨m ki·∫øm */
      .suggestion-tags {
          margin-top: 20px;
          padding-top: 20px;
          border-top: 2px solid #e0e0e0;
      }

      .suggestion-tags p {
          color: #555;
          margin-bottom: 12px;
          font-size: 15px;
          font-weight: 500;
      }

      .tags-container {
          display: flex;
          gap: 10px;
          flex-wrap: wrap;
      }

      .tag-item {
          padding: 10px 20px;
          background: #f5f5f5;
          border-radius: 25px;
          font-size: 14px;
          font-weight: 500;
          cursor: pointer;
          transition: 0.3s;
          color: #555;
      }

      .tag-item:hover {
          background: linear-gradient(135deg, #8EB486, #1C6758);
          color: white;
          transform: translateY(-2px);
          box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      }

      /* N·ªôi dung ch√≠nh */
      .container {
          max-width: 1400px;
          margin: 40px auto;
          padding: 0 20px;
      }

      .section-title {
          text-align: center;
          font-size: 2.2em;
          font-weight: 700;
          color: #333;
          margin-bottom: 35px;
          font-family: 'Poppins', sans-serif;
      }

      .image-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
          gap: 25px;
          margin-bottom: 60px;
      }

      .image-card {
          background: white;
          border-radius: 15px;
          overflow: hidden;
          box-shadow: 0 5px 20px rgba(0,0,0,0.08);
          cursor: pointer;
          transition: 0.3s;
      }

      .image-card:hover {
          transform: translateY(-8px);
          box-shadow: 0 15px 35px rgba(0,0,0,0.15);
      }

      .image-card img {
          width: 100%;
          height: 220px;
          object-fit: cover;
      }

      .image-info { 
          padding: 18px; 
      }

      .image-info h3 { 
          margin-bottom: 8px;
          color: #333;
          font-size: 18px;
          font-weight: 600;
          font-family: 'Poppins', sans-serif;
      }

      .tags { 
          color: #8EB486; 
          font-size: 13px;
          margin-bottom: 5px;
          font-weight: 500;
      }

      .rating {
          color: #FFB800;
          font-size: 14px;
          font-weight: 600;
      }

      .no-results { 
          text-align: center; 
          padding: 60px 20px; 
          color: #999;
          font-size: 18px;
      }

      /* Footer */
      footer {
          background: #2C3E50;
          color: white;
          padding: 50px 20px 20px;
          margin-top: 80px;
      }

      .footer-container {
          max-width: 1400px;
          margin: 0 auto;
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 40px;
          margin-bottom: 30px;
      }

      .footer-section h3 {
          margin-bottom: 20px;
          color: #8EB486;
          font-weight: 600;
          font-size: 18px;
      }

      .footer-section p, .footer-section li {
          line-height: 1.8;
          color: #bbb;
          margin-bottom: 10px;
          font-size: 14px;
      }

      .footer-bottom {
          text-align: center;
          padding-top: 30px;
          border-top: 1px solid #444;
          color: #888;
      }

      /* N√∫t cu·ªôn l√™n ƒë·∫ßu trang */
      #scrollTop {
          position: fixed;
          bottom: 30px;
          right: 30px;
          background: linear-gradient(135deg, #1C6758,  #8EB486);
          color: white;
          width: 50px;
          height: 50px;
          border-radius: 50%;
          border: none;
          cursor: pointer;
          font-size: 20px;
          display: none;
          box-shadow: 0 5px 15px rgba(0,0,0,0.3);
          transition: 0.3s;
          z-index: 999;
      }

      #scrollTop:hover {
          transform: translateY(-5px);
      }

      #scrollTop.show {
          display: block;
      }

      /* Responsive - Giao di·ªán mobile */
      @media (max-width: 768px) {
          .hero h1 {
              font-size: 2em;
          }

          .search-row {
              flex-direction: column;
          }

          .search-row input {
              min-width: 100%;
          }

          .nav-links {
              flex-wrap: wrap;
              gap: 10px;
          }
      }
  </style>
</head>
<body>

  <!-- Header -->
  <header>
      <div class="header-container">
          <a href="/" class="logo">Loca<span>Go!</span></a>
          <div class="nav-links">
              <select id="languageSelect">
                  <option value="vi">Ti·∫øng Vi·ªát</option>
                  <option value="en">English</option>
              </select>
              <a href="/MapRouting">B·∫£n ƒë·ªì</a>
              <a href="/chat_ui">Chatbot du l·ªãch</a>
              <a href="/forum">Forum</a>
              <a href="{{ url_for('login_bp.register') }}" class="btn-secondary">ƒêƒÉng k√Ω</a>
              <a href="{{ url_for('login_bp.login') }}" class="btn-primary">ƒêƒÉng nh·∫≠p</a>
          </div>
      </div>
  </header>

  <!-- Ph·∫ßn Hero v·ªõi form t√¨m ki·∫øm -->
  <section class="hero">
      <h1>Kh√°m ph√° phi√™n b·∫£n tuy·ªát nh·∫•t c·ªßa b·∫°n!</h1>
      <p>M·ªü ra ch√¢n tr·ªùi m·ªõi, ƒëam m√™ m·ªõi v√† ƒë√°nh th·ª©c phi√™n b·∫£n r·ª±c r·ª° c·ªßa b·∫°n c√πng LocaGo!</p>

      <div class="search-container">
          <!-- C√°c tab t√¨m ki·∫øm -->
          <div class="search-tabs">
              <div class="tab active" onclick="switchTab('keyword')">T·ª´ kh√≥a</div>
              <div class="tab" onclick="switchTab('filter')">Th√†nh ph·ªë & Th·∫ª</div>
              <div class="tab" onclick="switchTab('ai')">T√¨m b·∫±ng AI</div>
              <div class="tab" onclick="switchTab('image')">T√¨m b·∫±ng h√¨nh ·∫£nh</div>
          </div>

          <!-- T√¨m ki·∫øm theo t·ª´ kh√≥a -->
          <div id="keyword" class="search-form active">
              <div class="search-row">
                  <input type="text" id="searchInput" placeholder="Nh·∫≠p t·ª´ kh√≥a: cat, dog, mountain...">
                  <button class="search-button" onclick="searchImages()">T√¨m ki·∫øm</button>
              </div>
          </div>

          <!-- T√¨m ki·∫øm theo b·ªô l·ªçc -->
          <div id="filter" class="search-form">
              <div class="search-row">
                  <input type="text" id="cityInput" placeholder="Th√†nh ph·ªë (VD: H√† N·ªôi)">
                  <input type="text" id="tagInput" placeholder="Th·∫ª (VD: l·ªãch s·ª≠, bi·ªÉn)">
                  <input type="number" id="ratingInput" min="0" max="5" step="0.5" placeholder="ƒêi·ªÉm ƒë√°nh gi√°">
                  <button class="search-button" onclick="searchFilter()">L·ªçc</button>
              </div>
          </div>

          <!-- T√¨m ki·∫øm b·∫±ng AI -->
          <div id="ai" class="search-form">
              <div class="search-row">
                  <input type="text" id="queryText" placeholder="VD: ƒë·ªãa ƒëi·ªÉm c√≥ nhi·ªÅu c√¢y xanh, g·∫ßn bi·ªÉn...">
                  <button class="search-button" onclick="searchText()">T√¨m b·∫±ng AI</button>
              </div>
          </div>

          <!-- T√¨m ki·∫øm b·∫±ng h√¨nh ·∫£nh -->
          <div id="image" class="search-form">
              <div class="search-row">
                  <input type="file" id="imageUpload" accept="image/*" style="padding: 12px;">
                  <button class="search-button" onclick="searchByImage()">T√¨m b·∫±ng ·∫£nh</button>
              </div>
          </div>

          <!-- G·ª£i √Ω tag -->
          <div class="suggestion-tags">
              <p>üí° G·ª£i √Ω t√¨m ki·∫øm ph·ªï bi·∫øn:</p>
              <div class="tags-container">
                  <span class="tag-item" onclick="quickSearch('ngh·ªâ d∆∞·ª°ng')">ngh·ªâ d∆∞·ª°ng</span>
                  <span class="tag-item" onclick="quickSearch('mi·ªÅn T√¢y')">mi·ªÅn T√¢y</span>
                  <span class="tag-item" onclick="quickSearch('thi√™n nhi√™n')">thi√™n nhi√™n</span>
                  <span class="tag-item" onclick="quickSearch('bi·ªÉn')">bi·ªÉn</span>
                  <span class="tag-item" onclick="quickSearch('n√∫i')">n√∫i</span>
                  <span class="tag-item" onclick="quickSearch('vƒÉn h√≥a')">vƒÉn h√≥a</span>
                  <span class="tag-item" onclick="quickSearch('·∫©m th·ª±c')">·∫©m th·ª±c</span>
                  <span class="tag-item" onclick="quickSearch('l·ªãch s·ª≠')">l·ªãch s·ª≠</span>
              </div>
          </div>
      </div>
  </section>

  <!-- N·ªôi dung ch√≠nh -->
  <div class="container">
      <h2 class="section-title">Kh√°m ph√° ƒëi·ªÉm ƒë·∫øn</h2>
      
      <div id="results" class="image-grid">
      </div>
  </div>

  <!-- Footer -->
  <footer>
      <div class="footer-container">
          <div class="footer-section">
              <h3>V·ªÅ LocaGo!</h3>
              <p>24127552 - Nguy·ªÖn V√µ Nh·∫≠t Thu·∫≠n </p>
              <p>24127386 - V≈© ƒê·ªó M·∫°nh H√πng </p>
              <p>24127248 - Nguy·ªÖn Tr·∫ßn Ph∆∞∆°ng Th√∫y </p>
              <p>24127086 - Tr·∫ßn Ho√†ng Kh√°nh My </p>
              <p>24127302 - Nguy·ªÖn Xu√¢n Quy√™n </p>
              <p>24127106 - Lai Ph·∫°m Nh∆∞ Ph√∫c  </p>
              <p>24127207 - Nguy·ªÖn Th·ª•c Nghi  </p>
              <p style="margin-top: 15px;">H√£y ƒë·ªÉ ch√∫ng t√¥i ƒë·ªìng h√†nh c√πng b·∫°n trong m·ªçi h√†nh tr√¨nh!</p>
          </div>

          <div class="footer-section">
              <h3>Th√¥ng tin m√¥n h·ªçc</h3>
              <p><strong>M√¥n:</strong> T∆∞ duy t√≠nh to√°n</p>
              <p><strong>M√£ m√¥n:</strong> CSC10014</p>
              <p><strong>Gi·∫£ng vi√™n:</strong> TS. L√™ Ng·ªçc Th√†nh</p>
              <p><strong>Tr∆∞·ªùng:</strong> ƒê·∫°i h·ªçc Khoa h·ªçc T·ª± nhi√™n, ƒêHQG-HCM</p>
          </div>

          <div class="footer-section">
              <h3>Li√™n h·ªá</h3>
              <p>üìß Email: locago@hcmus.edu.vn</p>
              <p>üì± Hotline: 1900 xxxx</p>
              <p>üè¢ ƒê·ªãa ch·ªâ: 227, Nguy·ªÖn VƒÉn C·ª´, P.Ch·ª£ Qu√°n, TP.HCM</p>
          </div>
      </div>

      <div class="footer-bottom">
          <p>¬© 2025 LocaGo! - All Rights Reserved | Designed with ‚ù§Ô∏è for travelers</p>
      </div>
  </footer>

  <!-- N√∫t cu·ªôn l√™n ƒë·∫ßu trang -->
  <button id="scrollTop" onclick="scrollToTop()">‚Üë</button>

  <script>
      // Chuy·ªÉn ƒë·ªïi gi·ªØa c√°c tab t√¨m ki·∫øm
      function switchTab(tabName) {
          document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
          document.querySelectorAll('.search-form').forEach(f => f.classList.remove('active'));
          
          event.target.classList.add('active');
          document.getElementById(tabName).classList.add('active');
      }

      // T√¨m ki·∫øm nhanh t·ª´ c√°c tag g·ª£i √Ω
      function quickSearch(keyword) {
          document.getElementById('searchInput').value = keyword;
          // Chuy·ªÉn sang tab keyword
          document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
          document.querySelectorAll('.search-form').forEach(f => f.classList.remove('active'));
          document.querySelector('.tab').classList.add('active');
          document.getElementById('keyword').classList.add('active');
          // Th·ª±c hi·ªán t√¨m ki·∫øm
          searchImages();
      }

      // C√°c h√†m t√¨m ki·∫øm
      async function searchImages() {
          const query = document.getElementById('searchInput').value.trim();
          
          try {
              const res = await fetch(`/api/search?q=${encodeURIComponent(query)}`);
              const data = await res.json();
              displayResults(data, query);
          } catch (error) {
              console.error('L·ªói t√¨m ki·∫øm:', error);
              document.getElementById('results').innerHTML = 
                  '<div class="no-results">ƒê√£ x·∫£y ra l·ªói khi t√¨m ki·∫øm. Vui l√≤ng th·ª≠ l·∫°i.</div>';
          }
      }

      async function searchFilter() {
          const city = document.getElementById('cityInput').value.trim();
          const tag = document.getElementById('tagInput').value.trim();
          const rating = document.getElementById('ratingInput').value.trim() || 0;

          try {
              const url = `/search_filter?city=${encodeURIComponent(city)}&tag=${encodeURIComponent(tag)}&rating=${rating}`;
              const res = await fetch(url);
              const data = await res.json();
              displayResults(data);
          } catch (error) {
              console.error('L·ªói l·ªçc:', error);
              document.getElementById('results').innerHTML = 
                  '<div class="no-results">ƒê√£ x·∫£y ra l·ªói khi l·ªçc. Vui l√≤ng th·ª≠ l·∫°i.</div>';
          }
      }

      async function searchText() {
          const query = document.getElementById('queryText').value.trim();
          if (!query) {
              alert('Vui l√≤ng nh·∫≠p n·ªôi dung t√¨m ki·∫øm!');
              return;
          }

          try {
              const res = await fetch(`/search_text?query=${encodeURIComponent(query)}`);
              const data = await res.json();
              displayResults(data);
          } catch (error) {
              console.error('L·ªói t√¨m ki·∫øm AI:', error);
              document.getElementById('results').innerHTML = 
                  '<div class="no-results">ƒê√£ x·∫£y ra l·ªói khi t√¨m ki·∫øm. Vui l√≤ng th·ª≠ l·∫°i.</div>';
          }
      }

      async function searchByImage() {
          const fileInput = document.getElementById('imageUpload');
          const file = fileInput.files[0];
          
          if (!file) {
              alert('Vui l√≤ng ch·ªçn m·ªôt h√¨nh ·∫£nh!');
              return;
          }

          const formData = new FormData();
          formData.append('file', file);

          try {
              const res = await fetch('/search_image', {
                  method: 'POST',
                  body: formData
              });
              
              if (res.headers.get('content-type').includes('text/html')) {
                  window.location.href = '/search_image';
                  return;
              }
              
              const data = await res.json();
              displayResults(data);
          } catch (error) {
              console.error('L·ªói t√¨m ki·∫øm ·∫£nh:', error);
              document.getElementById('results').innerHTML = 
                  '<div class="no-results">ƒê√£ x·∫£y ra l·ªói khi t√¨m ki·∫øm. Vui l√≤ng th·ª≠ l·∫°i.</div>';
          }
      }

      // Hi·ªÉn th·ªã k·∫øt qu·∫£ t√¨m ki·∫øm
      function displayResults(data, query = '') {
          const container = document.getElementById('results');
          if (!container) return;

          if (!data || data.length === 0) {
              container.innerHTML = `<div class="no-results">Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ ${query ? 'cho "' + query + '"' : ''}</div>`;
              return;
          }

          container.innerHTML = data.map(place => `
              <div class="image-card" onclick="viewDetail(${place.id})">
                  <img src="/static/images/${place.filename || 'default.jpg'}" 
                       alt="${place.name || 'H√¨nh ·∫£nh'}"
                       onerror="this.src='https://via.placeholder.com/280x220?text=No+Image'">
                  <div class="image-info">
                      <h3>${place.name || 'Ch∆∞a c√≥ t√™n'}</h3>
                      <div class="tags">${place.city || ''} ${place.tags ? '- ' + place.tags : ''}</div>
                      <div class="rating">‚≠ê ${place.rating || '0'}</div>
                  </div>
              </div>
          `).join('');
      }

      // Xem chi ti·∫øt ƒë·ªãa ƒëi·ªÉm
      function viewDetail(imageId) {
          window.location.href = '/image/' + imageId;
      }

      // X·ª≠ l√Ω hi·ªÉn th·ªã n√∫t cu·ªôn l√™n
      window.onscroll = function() {
          const scrollBtn = document.getElementById('scrollTop');
          if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
              scrollBtn.classList.add('show');
          } else {
              scrollBtn.classList.remove('show');
          }
      };

      // Cu·ªôn l√™n ƒë·∫ßu trang
      function scrollToTop() {
          window.scrollTo({
              top: 0,
              behavior: 'smooth'
          });
      }

      // H·ªó tr·ª£ ph√≠m Enter ƒë·ªÉ t√¨m ki·∫øm
      document.getElementById('searchInput').addEventListener('keypress', e => {
          if (e.key === 'Enter') searchImages();
      });

      document.getElementById('queryText').addEventListener('keypress', e => {
          if (e.key === 'Enter') searchText();
      });

      // T·∫£i d·ªØ li·ªáu ban ƒë·∫ßu khi m·ªü trang
      window.onload = async function() {
          try {
              const res = await fetch('/api/search?q=');
              const data = await res.json();
              displayResults(data);
          } catch (error) {
              console.error('L·ªói t·∫£i d·ªØ li·ªáu:', error);
              document.getElementById('results').innerHTML = 
                  '<div class="no-results">ƒêang t·∫£i d·ªØ li·ªáu...</div>';
          }
      };
  </script>

</body>
</html>
